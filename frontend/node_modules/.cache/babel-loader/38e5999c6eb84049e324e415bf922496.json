{"ast":null,"code":"/*\n * Copyright 2017 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __assign, __decorate, __extends } from \"tslib\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\nimport { polyfill } from \"react-lifecycles-compat\";\nimport { AbstractPureComponent2, Classes, DISPLAYNAME_PREFIX, Intent, Keys, Position, refHandler, removeNonHTMLProps, Utils } from \"../../common\";\nimport * as Errors from \"../../common/errors\";\nimport { ButtonGroup } from \"../button/buttonGroup\";\nimport { Button } from \"../button/buttons\";\nimport { ControlGroup } from \"./controlGroup\";\nimport { InputGroup } from \"./inputGroup\";\nimport { clampValue, getValueOrEmptyValue, isValidNumericKeyboardEvent, isValueNumeric, parseStringToStringNumber, sanitizeNumericInput, toLocaleString, toMaxPrecision } from \"./numericInputUtils\";\nvar IncrementDirection;\n\n(function (IncrementDirection) {\n  IncrementDirection[IncrementDirection[\"DOWN\"] = -1] = \"DOWN\";\n  IncrementDirection[IncrementDirection[\"UP\"] = 1] = \"UP\";\n})(IncrementDirection || (IncrementDirection = {}));\n\nvar NON_HTML_PROPS = [\"allowNumericCharactersOnly\", \"buttonPosition\", \"clampValueOnBlur\", \"className\", \"defaultValue\", \"majorStepSize\", \"minorStepSize\", \"onButtonClick\", \"onValueChange\", \"selectAllOnFocus\", \"selectAllOnIncrement\", \"stepSize\"];\n\nvar NumericInput =\n/** @class */\nfunction (_super) {\n  __extends(NumericInput, _super);\n\n  function NumericInput() {\n    var _a;\n\n    var _this = _super.apply(this, arguments) || this;\n\n    _this.state = {\n      currentImeInputInvalid: false,\n      shouldSelectAfterUpdate: false,\n      stepMaxPrecision: NumericInput_1.getStepMaxPrecision(_this.props),\n      value: getValueOrEmptyValue((_a = _this.props.value) !== null && _a !== void 0 ? _a : _this.props.defaultValue)\n    }; // updating these flags need not trigger re-renders, so don't include them in this.state.\n\n    _this.didPasteEventJustOccur = false;\n    _this.delta = 0;\n    _this.inputElement = null;\n    _this.inputRef = refHandler(_this, \"inputElement\", _this.props.inputRef);\n    _this.incrementButtonHandlers = _this.getButtonEventHandlers(IncrementDirection.UP);\n    _this.decrementButtonHandlers = _this.getButtonEventHandlers(IncrementDirection.DOWN);\n\n    _this.handleButtonClick = function (e, direction) {\n      var _a, _b;\n\n      var delta = _this.updateDelta(direction, e);\n\n      var nextValue = _this.incrementValue(delta);\n\n      (_b = (_a = _this.props).onButtonClick) === null || _b === void 0 ? void 0 : _b.call(_a, Number(parseStringToStringNumber(nextValue, _this.props.locale)), nextValue);\n    };\n\n    _this.stopContinuousChange = function () {\n      _this.delta = 0;\n\n      _this.clearTimeouts();\n\n      clearInterval(_this.intervalId);\n      document.removeEventListener(\"mouseup\", _this.stopContinuousChange);\n    };\n\n    _this.handleContinuousChange = function () {\n      var _a, _b, _c, _d; // If either min or max prop is set, when reaching the limit\n      // the button will be disabled and stopContinuousChange will be never fired,\n      // hence the need to check on each iteration to properly clear the timeout\n\n\n      if (_this.props.min !== undefined || _this.props.max !== undefined) {\n        var min = (_a = _this.props.min) !== null && _a !== void 0 ? _a : -Infinity;\n        var max = (_b = _this.props.max) !== null && _b !== void 0 ? _b : Infinity;\n        var valueAsNumber = Number(parseStringToStringNumber(_this.state.value, _this.props.locale));\n\n        if (valueAsNumber <= min || valueAsNumber >= max) {\n          _this.stopContinuousChange();\n\n          return;\n        }\n      }\n\n      var nextValue = _this.incrementValue(_this.delta);\n\n      (_d = (_c = _this.props).onButtonClick) === null || _d === void 0 ? void 0 : _d.call(_c, Number(parseStringToStringNumber(nextValue, _this.props.locale)), nextValue);\n    }; // Callbacks - Input\n    // =================\n\n\n    _this.handleInputFocus = function (e) {\n      var _a, _b; // update this state flag to trigger update for input selection (see componentDidUpdate)\n\n\n      _this.setState({\n        shouldSelectAfterUpdate: _this.props.selectAllOnFocus\n      });\n\n      (_b = (_a = _this.props).onFocus) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    };\n\n    _this.handleInputBlur = function (e) {\n      var _a, _b; // always disable this flag on blur so it's ready for next time.\n\n\n      _this.setState({\n        shouldSelectAfterUpdate: false\n      });\n\n      if (_this.props.clampValueOnBlur) {\n        var value = e.target.value;\n\n        _this.handleNextValue(_this.roundAndClampValue(value));\n      }\n\n      (_b = (_a = _this.props).onBlur) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    };\n\n    _this.handleInputKeyDown = function (e) {\n      var _a, _b;\n\n      if (_this.props.disabled || _this.props.readOnly) {\n        return;\n      } // eslint-disable-next-line deprecation/deprecation\n\n\n      var keyCode = e.keyCode;\n      var direction;\n\n      if (keyCode === Keys.ARROW_UP) {\n        direction = IncrementDirection.UP;\n      } else if (keyCode === Keys.ARROW_DOWN) {\n        direction = IncrementDirection.DOWN;\n      }\n\n      if (direction !== undefined) {\n        // when the input field has focus, some key combinations will modify\n        // the field's selection range. we'll actually want to select all\n        // text in the field after we modify the value on the following\n        // lines. preventing the default selection behavior lets us do that\n        // without interference.\n        e.preventDefault();\n\n        var delta = _this.updateDelta(direction, e);\n\n        _this.incrementValue(delta);\n      }\n\n      (_b = (_a = _this.props).onKeyDown) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    };\n\n    _this.handleCompositionEnd = function (e) {\n      if (_this.props.allowNumericCharactersOnly) {\n        _this.handleNextValue(sanitizeNumericInput(e.data, _this.props.locale));\n\n        _this.setState({\n          currentImeInputInvalid: false\n        });\n      }\n    };\n\n    _this.handleCompositionUpdate = function (e) {\n      if (_this.props.allowNumericCharactersOnly) {\n        var data = e.data;\n        var sanitizedValue = sanitizeNumericInput(data, _this.props.locale);\n\n        if (sanitizedValue.length === 0 && data.length > 0) {\n          _this.setState({\n            currentImeInputInvalid: true\n          });\n        } else {\n          _this.setState({\n            currentImeInputInvalid: false\n          });\n        }\n      }\n    };\n\n    _this.handleInputKeyPress = function (e) {\n      var _a, _b; // we prohibit keystrokes in onKeyPress instead of onKeyDown, because\n      // e.key is not trustworthy in onKeyDown in all browsers.\n\n\n      if (_this.props.allowNumericCharactersOnly && !isValidNumericKeyboardEvent(e, _this.props.locale)) {\n        e.preventDefault();\n      }\n\n      (_b = (_a = _this.props).onKeyPress) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    };\n\n    _this.handleInputPaste = function (e) {\n      var _a, _b;\n\n      _this.didPasteEventJustOccur = true;\n      (_b = (_a = _this.props).onPaste) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    };\n\n    _this.handleInputChange = function (e) {\n      var value = e.target.value;\n      var nextValue = value;\n\n      if (_this.props.allowNumericCharactersOnly && _this.didPasteEventJustOccur) {\n        _this.didPasteEventJustOccur = false;\n        nextValue = sanitizeNumericInput(value, _this.props.locale);\n      }\n\n      _this.handleNextValue(nextValue);\n\n      _this.setState({\n        shouldSelectAfterUpdate: false\n      });\n    };\n\n    return _this;\n  }\n\n  NumericInput_1 = NumericInput;\n\n  NumericInput.getDerivedStateFromProps = function (props, state) {\n    var _a, _b;\n\n    var nextState = {\n      prevMaxProp: props.max,\n      prevMinProp: props.min\n    };\n    var didMinChange = props.min !== state.prevMinProp;\n    var didMaxChange = props.max !== state.prevMaxProp;\n    var didBoundsChange = didMinChange || didMaxChange; // in controlled mode, use props.value\n    // in uncontrolled mode, if state.value has not been assigned yet (upon initial mount), use props.defaultValue\n\n    var value = (_b = (_a = props.value) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : state.value;\n    var stepMaxPrecision = NumericInput_1.getStepMaxPrecision(props);\n    var sanitizedValue = value !== NumericInput_1.VALUE_EMPTY ? NumericInput_1.roundAndClampValue(value, stepMaxPrecision, props.min, props.max, 0, props.locale) : NumericInput_1.VALUE_EMPTY; // if a new min and max were provided that cause the existing value to fall\n    // outside of the new bounds, then clamp the value to the new valid range.\n\n    if (didBoundsChange && sanitizedValue !== state.value) {\n      return __assign(__assign({}, nextState), {\n        stepMaxPrecision: stepMaxPrecision,\n        value: sanitizedValue\n      });\n    }\n\n    return __assign(__assign({}, nextState), {\n      stepMaxPrecision: stepMaxPrecision,\n      value: value\n    });\n  }; // Value Helpers\n  // =============\n\n\n  NumericInput.getStepMaxPrecision = function (props) {\n    if (props.minorStepSize != null) {\n      return Utils.countDecimalPlaces(props.minorStepSize);\n    } else {\n      return Utils.countDecimalPlaces(props.stepSize);\n    }\n  };\n\n  NumericInput.roundAndClampValue = function (value, stepMaxPrecision, min, max, delta, locale) {\n    if (delta === void 0) {\n      delta = 0;\n    }\n\n    if (!isValueNumeric(value, locale)) {\n      return NumericInput_1.VALUE_EMPTY;\n    }\n\n    var currentValue = parseStringToStringNumber(value, locale);\n    var nextValue = toMaxPrecision(Number(currentValue) + delta, stepMaxPrecision);\n    var clampedValue = clampValue(nextValue, min, max);\n    return toLocaleString(clampedValue, locale);\n  };\n\n  NumericInput.prototype.render = function () {\n    var _a;\n\n    var _b = this.props,\n        buttonPosition = _b.buttonPosition,\n        className = _b.className,\n        fill = _b.fill,\n        large = _b.large;\n    var containerClasses = classNames(Classes.NUMERIC_INPUT, (_a = {}, _a[Classes.LARGE] = large, _a), className);\n    var buttons = this.renderButtons();\n    return React.createElement(ControlGroup, {\n      className: containerClasses,\n      fill: fill\n    }, buttonPosition === Position.LEFT && buttons, this.renderInput(), buttonPosition === Position.RIGHT && buttons);\n  };\n\n  NumericInput.prototype.componentDidUpdate = function (prevProps, prevState) {\n    var _a, _b, _c;\n\n    _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n\n    if (this.state.shouldSelectAfterUpdate) {\n      (_a = this.inputElement) === null || _a === void 0 ? void 0 : _a.setSelectionRange(0, this.state.value.length);\n    }\n\n    var didMinChange = this.props.min !== prevProps.min;\n    var didMaxChange = this.props.max !== prevProps.max;\n    var didBoundsChange = didMinChange || didMaxChange;\n    var didLocaleChange = this.props.locale !== prevProps.locale;\n    var didValueChange = this.state.value !== prevState.value;\n\n    if (didBoundsChange && didValueChange || didLocaleChange && prevState.value !== NumericInput_1.VALUE_EMPTY) {\n      // we clamped the value due to a bounds change, so we should fire the change callback\n      var valueToParse = didLocaleChange ? prevState.value : this.state.value;\n      var valueAsString = parseStringToStringNumber(valueToParse, prevProps.locale);\n      var localizedValue = toLocaleString(+valueAsString, this.props.locale);\n      (_c = (_b = this.props).onValueChange) === null || _c === void 0 ? void 0 : _c.call(_b, +valueAsString, localizedValue, this.inputElement);\n    }\n  };\n\n  NumericInput.prototype.validateProps = function (nextProps) {\n    var majorStepSize = nextProps.majorStepSize,\n        max = nextProps.max,\n        min = nextProps.min,\n        minorStepSize = nextProps.minorStepSize,\n        stepSize = nextProps.stepSize,\n        value = nextProps.value;\n\n    if (min != null && max != null && min > max) {\n      console.error(Errors.NUMERIC_INPUT_MIN_MAX);\n    }\n\n    if (stepSize <= 0) {\n      console.error(Errors.NUMERIC_INPUT_STEP_SIZE_NON_POSITIVE);\n    }\n\n    if (minorStepSize && minorStepSize <= 0) {\n      console.error(Errors.NUMERIC_INPUT_MINOR_STEP_SIZE_NON_POSITIVE);\n    }\n\n    if (majorStepSize && majorStepSize <= 0) {\n      console.error(Errors.NUMERIC_INPUT_MAJOR_STEP_SIZE_NON_POSITIVE);\n    }\n\n    if (minorStepSize && minorStepSize > stepSize) {\n      console.error(Errors.NUMERIC_INPUT_MINOR_STEP_SIZE_BOUND);\n    }\n\n    if (majorStepSize && majorStepSize < stepSize) {\n      console.error(Errors.NUMERIC_INPUT_MAJOR_STEP_SIZE_BOUND);\n    } // controlled mode\n\n\n    if (value != null) {\n      var stepMaxPrecision = NumericInput_1.getStepMaxPrecision(nextProps);\n      var sanitizedValue = NumericInput_1.roundAndClampValue(value.toString(), stepMaxPrecision, min, max, 0, this.props.locale);\n      var valueDoesNotMatch = sanitizedValue !== value.toString();\n      var localizedValue = toLocaleString(Number(parseStringToStringNumber(value, this.props.locale)), this.props.locale);\n      var isNotLocalized = sanitizedValue !== localizedValue;\n\n      if (valueDoesNotMatch && isNotLocalized) {\n        console.warn(Errors.NUMERIC_INPUT_CONTROLLED_VALUE_INVALID);\n      }\n    }\n  }; // Render Helpers\n  // ==============\n\n\n  NumericInput.prototype.renderButtons = function () {\n    var _a = this.props,\n        intent = _a.intent,\n        max = _a.max,\n        min = _a.min,\n        locale = _a.locale;\n    var value = parseStringToStringNumber(this.state.value, locale);\n    var disabled = this.props.disabled || this.props.readOnly;\n    var isIncrementDisabled = max !== undefined && value !== \"\" && +value >= max;\n    var isDecrementDisabled = min !== undefined && value !== \"\" && +value <= min;\n    return React.createElement(ButtonGroup, {\n      className: Classes.FIXED,\n      key: \"button-group\",\n      vertical: true\n    }, React.createElement(Button, __assign({\n      disabled: disabled || isIncrementDisabled,\n      icon: \"chevron-up\",\n      intent: intent\n    }, this.incrementButtonHandlers)), React.createElement(Button, __assign({\n      disabled: disabled || isDecrementDisabled,\n      icon: \"chevron-down\",\n      intent: intent\n    }, this.decrementButtonHandlers)));\n  };\n\n  NumericInput.prototype.renderInput = function () {\n    var inputGroupHtmlProps = removeNonHTMLProps(this.props, NON_HTML_PROPS, true);\n    return React.createElement(InputGroup, __assign({\n      asyncControl: this.props.asyncControl,\n      autoComplete: \"off\"\n    }, inputGroupHtmlProps, {\n      intent: this.state.currentImeInputInvalid ? Intent.DANGER : this.props.intent,\n      inputRef: this.inputRef,\n      large: this.props.large,\n      leftIcon: this.props.leftIcon,\n      onFocus: this.handleInputFocus,\n      onBlur: this.handleInputBlur,\n      onChange: this.handleInputChange,\n      onCompositionEnd: this.handleCompositionEnd,\n      onCompositionUpdate: this.handleCompositionUpdate,\n      onKeyDown: this.handleInputKeyDown,\n      onKeyPress: this.handleInputKeyPress,\n      onPaste: this.handleInputPaste,\n      rightElement: this.props.rightElement,\n      value: this.state.value\n    }));\n  }; // Callbacks - Buttons\n  // ===================\n\n\n  NumericInput.prototype.getButtonEventHandlers = function (direction) {\n    var _this = this;\n\n    return {\n      // keydown is fired repeatedly when held so it's implicitly continuous\n      onKeyDown: function (evt) {\n        // eslint-disable-next-line deprecation/deprecation\n        if (!_this.props.disabled && Keys.isKeyboardClick(evt.keyCode)) {\n          _this.handleButtonClick(evt, direction);\n        }\n      },\n      onMouseDown: function (evt) {\n        if (!_this.props.disabled) {\n          _this.handleButtonClick(evt, direction);\n\n          _this.startContinuousChange();\n        }\n      }\n    };\n  };\n\n  NumericInput.prototype.startContinuousChange = function () {\n    var _this = this; // The button's onMouseUp event handler doesn't fire if the user\n    // releases outside of the button, so we need to watch all the way\n    // from the top.\n\n\n    document.addEventListener(\"mouseup\", this.stopContinuousChange); // Initial delay is slightly longer to prevent the user from\n    // accidentally triggering the continuous increment/decrement.\n\n    this.setTimeout(function () {\n      _this.intervalId = window.setInterval(_this.handleContinuousChange, NumericInput_1.CONTINUOUS_CHANGE_INTERVAL);\n    }, NumericInput_1.CONTINUOUS_CHANGE_DELAY);\n  }; // Data logic\n  // ==========\n\n\n  NumericInput.prototype.handleNextValue = function (valueAsString) {\n    var _a, _b;\n\n    if (this.props.value == null) {\n      this.setState({\n        value: valueAsString\n      });\n    }\n\n    (_b = (_a = this.props).onValueChange) === null || _b === void 0 ? void 0 : _b.call(_a, Number(parseStringToStringNumber(valueAsString, this.props.locale)), valueAsString, this.inputElement);\n  };\n\n  NumericInput.prototype.incrementValue = function (delta) {\n    // pretend we're incrementing from 0 if currValue is empty\n    var currValue = this.state.value === NumericInput_1.VALUE_EMPTY ? NumericInput_1.VALUE_ZERO : this.state.value;\n    var nextValue = this.roundAndClampValue(currValue, delta);\n\n    if (nextValue !== this.state.value) {\n      this.handleNextValue(nextValue);\n      this.setState({\n        shouldSelectAfterUpdate: this.props.selectAllOnIncrement\n      });\n    } // return value used in continuous change updates\n\n\n    return nextValue;\n  };\n\n  NumericInput.prototype.getIncrementDelta = function (direction, isShiftKeyPressed, isAltKeyPressed) {\n    var _a = this.props,\n        majorStepSize = _a.majorStepSize,\n        minorStepSize = _a.minorStepSize,\n        stepSize = _a.stepSize;\n\n    if (isShiftKeyPressed && majorStepSize != null) {\n      return direction * majorStepSize;\n    } else if (isAltKeyPressed && minorStepSize != null) {\n      return direction * minorStepSize;\n    } else {\n      return direction * stepSize;\n    }\n  };\n\n  NumericInput.prototype.roundAndClampValue = function (value, delta) {\n    if (delta === void 0) {\n      delta = 0;\n    }\n\n    return NumericInput_1.roundAndClampValue(value, this.state.stepMaxPrecision, this.props.min, this.props.max, delta, this.props.locale);\n  };\n\n  NumericInput.prototype.updateDelta = function (direction, e) {\n    this.delta = this.getIncrementDelta(direction, e.shiftKey, e.altKey);\n    return this.delta;\n  };\n\n  var NumericInput_1;\n  NumericInput.displayName = DISPLAYNAME_PREFIX + \".NumericInput\";\n  NumericInput.VALUE_EMPTY = \"\";\n  NumericInput.VALUE_ZERO = \"0\";\n  NumericInput.defaultProps = {\n    allowNumericCharactersOnly: true,\n    buttonPosition: Position.RIGHT,\n    clampValueOnBlur: false,\n    defaultValue: NumericInput_1.VALUE_EMPTY,\n    large: false,\n    majorStepSize: 10,\n    minorStepSize: 0.1,\n    selectAllOnFocus: false,\n    selectAllOnIncrement: false,\n    stepSize: 1\n  };\n  NumericInput.CONTINUOUS_CHANGE_DELAY = 300;\n  NumericInput.CONTINUOUS_CHANGE_INTERVAL = 100;\n  NumericInput = NumericInput_1 = __decorate([polyfill], NumericInput);\n  return NumericInput;\n}(AbstractPureComponent2);\n\nexport { NumericInput };","map":{"version":3,"sources":["../../../../src/components/forms/numericInput.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright 2017 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __assign, __decorate, __extends } from \"tslib\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\nimport { polyfill } from \"react-lifecycles-compat\";\nimport { AbstractPureComponent2, Classes, DISPLAYNAME_PREFIX, Intent, Keys, Position, refHandler, removeNonHTMLProps, Utils, } from \"../../common\";\nimport * as Errors from \"../../common/errors\";\nimport { ButtonGroup } from \"../button/buttonGroup\";\nimport { Button } from \"../button/buttons\";\nimport { ControlGroup } from \"./controlGroup\";\nimport { InputGroup } from \"./inputGroup\";\nimport { clampValue, getValueOrEmptyValue, isValidNumericKeyboardEvent, isValueNumeric, parseStringToStringNumber, sanitizeNumericInput, toLocaleString, toMaxPrecision, } from \"./numericInputUtils\";\nvar IncrementDirection;\n(function (IncrementDirection) {\n    IncrementDirection[IncrementDirection[\"DOWN\"] = -1] = \"DOWN\";\n    IncrementDirection[IncrementDirection[\"UP\"] = 1] = \"UP\";\n})(IncrementDirection || (IncrementDirection = {}));\nvar NON_HTML_PROPS = [\n    \"allowNumericCharactersOnly\",\n    \"buttonPosition\",\n    \"clampValueOnBlur\",\n    \"className\",\n    \"defaultValue\",\n    \"majorStepSize\",\n    \"minorStepSize\",\n    \"onButtonClick\",\n    \"onValueChange\",\n    \"selectAllOnFocus\",\n    \"selectAllOnIncrement\",\n    \"stepSize\",\n];\nvar NumericInput = /** @class */ (function (_super) {\n    __extends(NumericInput, _super);\n    function NumericInput() {\n        var _a;\n        var _this = _super.apply(this, arguments) || this;\n        _this.state = {\n            currentImeInputInvalid: false,\n            shouldSelectAfterUpdate: false,\n            stepMaxPrecision: NumericInput_1.getStepMaxPrecision(_this.props),\n            value: getValueOrEmptyValue((_a = _this.props.value) !== null && _a !== void 0 ? _a : _this.props.defaultValue),\n        };\n        // updating these flags need not trigger re-renders, so don't include them in this.state.\n        _this.didPasteEventJustOccur = false;\n        _this.delta = 0;\n        _this.inputElement = null;\n        _this.inputRef = refHandler(_this, \"inputElement\", _this.props.inputRef);\n        _this.incrementButtonHandlers = _this.getButtonEventHandlers(IncrementDirection.UP);\n        _this.decrementButtonHandlers = _this.getButtonEventHandlers(IncrementDirection.DOWN);\n        _this.handleButtonClick = function (e, direction) {\n            var _a, _b;\n            var delta = _this.updateDelta(direction, e);\n            var nextValue = _this.incrementValue(delta);\n            (_b = (_a = _this.props).onButtonClick) === null || _b === void 0 ? void 0 : _b.call(_a, Number(parseStringToStringNumber(nextValue, _this.props.locale)), nextValue);\n        };\n        _this.stopContinuousChange = function () {\n            _this.delta = 0;\n            _this.clearTimeouts();\n            clearInterval(_this.intervalId);\n            document.removeEventListener(\"mouseup\", _this.stopContinuousChange);\n        };\n        _this.handleContinuousChange = function () {\n            var _a, _b, _c, _d;\n            // If either min or max prop is set, when reaching the limit\n            // the button will be disabled and stopContinuousChange will be never fired,\n            // hence the need to check on each iteration to properly clear the timeout\n            if (_this.props.min !== undefined || _this.props.max !== undefined) {\n                var min = (_a = _this.props.min) !== null && _a !== void 0 ? _a : -Infinity;\n                var max = (_b = _this.props.max) !== null && _b !== void 0 ? _b : Infinity;\n                var valueAsNumber = Number(parseStringToStringNumber(_this.state.value, _this.props.locale));\n                if (valueAsNumber <= min || valueAsNumber >= max) {\n                    _this.stopContinuousChange();\n                    return;\n                }\n            }\n            var nextValue = _this.incrementValue(_this.delta);\n            (_d = (_c = _this.props).onButtonClick) === null || _d === void 0 ? void 0 : _d.call(_c, Number(parseStringToStringNumber(nextValue, _this.props.locale)), nextValue);\n        };\n        // Callbacks - Input\n        // =================\n        _this.handleInputFocus = function (e) {\n            var _a, _b;\n            // update this state flag to trigger update for input selection (see componentDidUpdate)\n            _this.setState({ shouldSelectAfterUpdate: _this.props.selectAllOnFocus });\n            (_b = (_a = _this.props).onFocus) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        };\n        _this.handleInputBlur = function (e) {\n            var _a, _b;\n            // always disable this flag on blur so it's ready for next time.\n            _this.setState({ shouldSelectAfterUpdate: false });\n            if (_this.props.clampValueOnBlur) {\n                var value = e.target.value;\n                _this.handleNextValue(_this.roundAndClampValue(value));\n            }\n            (_b = (_a = _this.props).onBlur) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        };\n        _this.handleInputKeyDown = function (e) {\n            var _a, _b;\n            if (_this.props.disabled || _this.props.readOnly) {\n                return;\n            }\n            // eslint-disable-next-line deprecation/deprecation\n            var keyCode = e.keyCode;\n            var direction;\n            if (keyCode === Keys.ARROW_UP) {\n                direction = IncrementDirection.UP;\n            }\n            else if (keyCode === Keys.ARROW_DOWN) {\n                direction = IncrementDirection.DOWN;\n            }\n            if (direction !== undefined) {\n                // when the input field has focus, some key combinations will modify\n                // the field's selection range. we'll actually want to select all\n                // text in the field after we modify the value on the following\n                // lines. preventing the default selection behavior lets us do that\n                // without interference.\n                e.preventDefault();\n                var delta = _this.updateDelta(direction, e);\n                _this.incrementValue(delta);\n            }\n            (_b = (_a = _this.props).onKeyDown) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        };\n        _this.handleCompositionEnd = function (e) {\n            if (_this.props.allowNumericCharactersOnly) {\n                _this.handleNextValue(sanitizeNumericInput(e.data, _this.props.locale));\n                _this.setState({ currentImeInputInvalid: false });\n            }\n        };\n        _this.handleCompositionUpdate = function (e) {\n            if (_this.props.allowNumericCharactersOnly) {\n                var data = e.data;\n                var sanitizedValue = sanitizeNumericInput(data, _this.props.locale);\n                if (sanitizedValue.length === 0 && data.length > 0) {\n                    _this.setState({ currentImeInputInvalid: true });\n                }\n                else {\n                    _this.setState({ currentImeInputInvalid: false });\n                }\n            }\n        };\n        _this.handleInputKeyPress = function (e) {\n            var _a, _b;\n            // we prohibit keystrokes in onKeyPress instead of onKeyDown, because\n            // e.key is not trustworthy in onKeyDown in all browsers.\n            if (_this.props.allowNumericCharactersOnly && !isValidNumericKeyboardEvent(e, _this.props.locale)) {\n                e.preventDefault();\n            }\n            (_b = (_a = _this.props).onKeyPress) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        };\n        _this.handleInputPaste = function (e) {\n            var _a, _b;\n            _this.didPasteEventJustOccur = true;\n            (_b = (_a = _this.props).onPaste) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n        };\n        _this.handleInputChange = function (e) {\n            var value = e.target.value;\n            var nextValue = value;\n            if (_this.props.allowNumericCharactersOnly && _this.didPasteEventJustOccur) {\n                _this.didPasteEventJustOccur = false;\n                nextValue = sanitizeNumericInput(value, _this.props.locale);\n            }\n            _this.handleNextValue(nextValue);\n            _this.setState({ shouldSelectAfterUpdate: false });\n        };\n        return _this;\n    }\n    NumericInput_1 = NumericInput;\n    NumericInput.getDerivedStateFromProps = function (props, state) {\n        var _a, _b;\n        var nextState = {\n            prevMaxProp: props.max,\n            prevMinProp: props.min,\n        };\n        var didMinChange = props.min !== state.prevMinProp;\n        var didMaxChange = props.max !== state.prevMaxProp;\n        var didBoundsChange = didMinChange || didMaxChange;\n        // in controlled mode, use props.value\n        // in uncontrolled mode, if state.value has not been assigned yet (upon initial mount), use props.defaultValue\n        var value = (_b = (_a = props.value) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : state.value;\n        var stepMaxPrecision = NumericInput_1.getStepMaxPrecision(props);\n        var sanitizedValue = value !== NumericInput_1.VALUE_EMPTY\n            ? NumericInput_1.roundAndClampValue(value, stepMaxPrecision, props.min, props.max, 0, props.locale)\n            : NumericInput_1.VALUE_EMPTY;\n        // if a new min and max were provided that cause the existing value to fall\n        // outside of the new bounds, then clamp the value to the new valid range.\n        if (didBoundsChange && sanitizedValue !== state.value) {\n            return __assign(__assign({}, nextState), { stepMaxPrecision: stepMaxPrecision, value: sanitizedValue });\n        }\n        return __assign(__assign({}, nextState), { stepMaxPrecision: stepMaxPrecision, value: value });\n    };\n    // Value Helpers\n    // =============\n    NumericInput.getStepMaxPrecision = function (props) {\n        if (props.minorStepSize != null) {\n            return Utils.countDecimalPlaces(props.minorStepSize);\n        }\n        else {\n            return Utils.countDecimalPlaces(props.stepSize);\n        }\n    };\n    NumericInput.roundAndClampValue = function (value, stepMaxPrecision, min, max, delta, locale) {\n        if (delta === void 0) { delta = 0; }\n        if (!isValueNumeric(value, locale)) {\n            return NumericInput_1.VALUE_EMPTY;\n        }\n        var currentValue = parseStringToStringNumber(value, locale);\n        var nextValue = toMaxPrecision(Number(currentValue) + delta, stepMaxPrecision);\n        var clampedValue = clampValue(nextValue, min, max);\n        return toLocaleString(clampedValue, locale);\n    };\n    NumericInput.prototype.render = function () {\n        var _a;\n        var _b = this.props, buttonPosition = _b.buttonPosition, className = _b.className, fill = _b.fill, large = _b.large;\n        var containerClasses = classNames(Classes.NUMERIC_INPUT, (_a = {}, _a[Classes.LARGE] = large, _a), className);\n        var buttons = this.renderButtons();\n        return (React.createElement(ControlGroup, { className: containerClasses, fill: fill },\n            buttonPosition === Position.LEFT && buttons,\n            this.renderInput(),\n            buttonPosition === Position.RIGHT && buttons));\n    };\n    NumericInput.prototype.componentDidUpdate = function (prevProps, prevState) {\n        var _a, _b, _c;\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (this.state.shouldSelectAfterUpdate) {\n            (_a = this.inputElement) === null || _a === void 0 ? void 0 : _a.setSelectionRange(0, this.state.value.length);\n        }\n        var didMinChange = this.props.min !== prevProps.min;\n        var didMaxChange = this.props.max !== prevProps.max;\n        var didBoundsChange = didMinChange || didMaxChange;\n        var didLocaleChange = this.props.locale !== prevProps.locale;\n        var didValueChange = this.state.value !== prevState.value;\n        if ((didBoundsChange && didValueChange) || (didLocaleChange && prevState.value !== NumericInput_1.VALUE_EMPTY)) {\n            // we clamped the value due to a bounds change, so we should fire the change callback\n            var valueToParse = didLocaleChange ? prevState.value : this.state.value;\n            var valueAsString = parseStringToStringNumber(valueToParse, prevProps.locale);\n            var localizedValue = toLocaleString(+valueAsString, this.props.locale);\n            (_c = (_b = this.props).onValueChange) === null || _c === void 0 ? void 0 : _c.call(_b, +valueAsString, localizedValue, this.inputElement);\n        }\n    };\n    NumericInput.prototype.validateProps = function (nextProps) {\n        var majorStepSize = nextProps.majorStepSize, max = nextProps.max, min = nextProps.min, minorStepSize = nextProps.minorStepSize, stepSize = nextProps.stepSize, value = nextProps.value;\n        if (min != null && max != null && min > max) {\n            console.error(Errors.NUMERIC_INPUT_MIN_MAX);\n        }\n        if (stepSize <= 0) {\n            console.error(Errors.NUMERIC_INPUT_STEP_SIZE_NON_POSITIVE);\n        }\n        if (minorStepSize && minorStepSize <= 0) {\n            console.error(Errors.NUMERIC_INPUT_MINOR_STEP_SIZE_NON_POSITIVE);\n        }\n        if (majorStepSize && majorStepSize <= 0) {\n            console.error(Errors.NUMERIC_INPUT_MAJOR_STEP_SIZE_NON_POSITIVE);\n        }\n        if (minorStepSize && minorStepSize > stepSize) {\n            console.error(Errors.NUMERIC_INPUT_MINOR_STEP_SIZE_BOUND);\n        }\n        if (majorStepSize && majorStepSize < stepSize) {\n            console.error(Errors.NUMERIC_INPUT_MAJOR_STEP_SIZE_BOUND);\n        }\n        // controlled mode\n        if (value != null) {\n            var stepMaxPrecision = NumericInput_1.getStepMaxPrecision(nextProps);\n            var sanitizedValue = NumericInput_1.roundAndClampValue(value.toString(), stepMaxPrecision, min, max, 0, this.props.locale);\n            var valueDoesNotMatch = sanitizedValue !== value.toString();\n            var localizedValue = toLocaleString(Number(parseStringToStringNumber(value, this.props.locale)), this.props.locale);\n            var isNotLocalized = sanitizedValue !== localizedValue;\n            if (valueDoesNotMatch && isNotLocalized) {\n                console.warn(Errors.NUMERIC_INPUT_CONTROLLED_VALUE_INVALID);\n            }\n        }\n    };\n    // Render Helpers\n    // ==============\n    NumericInput.prototype.renderButtons = function () {\n        var _a = this.props, intent = _a.intent, max = _a.max, min = _a.min, locale = _a.locale;\n        var value = parseStringToStringNumber(this.state.value, locale);\n        var disabled = this.props.disabled || this.props.readOnly;\n        var isIncrementDisabled = max !== undefined && value !== \"\" && +value >= max;\n        var isDecrementDisabled = min !== undefined && value !== \"\" && +value <= min;\n        return (React.createElement(ButtonGroup, { className: Classes.FIXED, key: \"button-group\", vertical: true },\n            React.createElement(Button, __assign({ disabled: disabled || isIncrementDisabled, icon: \"chevron-up\", intent: intent }, this.incrementButtonHandlers)),\n            React.createElement(Button, __assign({ disabled: disabled || isDecrementDisabled, icon: \"chevron-down\", intent: intent }, this.decrementButtonHandlers))));\n    };\n    NumericInput.prototype.renderInput = function () {\n        var inputGroupHtmlProps = removeNonHTMLProps(this.props, NON_HTML_PROPS, true);\n        return (React.createElement(InputGroup, __assign({ asyncControl: this.props.asyncControl, autoComplete: \"off\" }, inputGroupHtmlProps, { intent: this.state.currentImeInputInvalid ? Intent.DANGER : this.props.intent, inputRef: this.inputRef, large: this.props.large, leftIcon: this.props.leftIcon, onFocus: this.handleInputFocus, onBlur: this.handleInputBlur, onChange: this.handleInputChange, onCompositionEnd: this.handleCompositionEnd, onCompositionUpdate: this.handleCompositionUpdate, onKeyDown: this.handleInputKeyDown, onKeyPress: this.handleInputKeyPress, onPaste: this.handleInputPaste, rightElement: this.props.rightElement, value: this.state.value })));\n    };\n    // Callbacks - Buttons\n    // ===================\n    NumericInput.prototype.getButtonEventHandlers = function (direction) {\n        var _this = this;\n        return {\n            // keydown is fired repeatedly when held so it's implicitly continuous\n            onKeyDown: function (evt) {\n                // eslint-disable-next-line deprecation/deprecation\n                if (!_this.props.disabled && Keys.isKeyboardClick(evt.keyCode)) {\n                    _this.handleButtonClick(evt, direction);\n                }\n            },\n            onMouseDown: function (evt) {\n                if (!_this.props.disabled) {\n                    _this.handleButtonClick(evt, direction);\n                    _this.startContinuousChange();\n                }\n            },\n        };\n    };\n    NumericInput.prototype.startContinuousChange = function () {\n        var _this = this;\n        // The button's onMouseUp event handler doesn't fire if the user\n        // releases outside of the button, so we need to watch all the way\n        // from the top.\n        document.addEventListener(\"mouseup\", this.stopContinuousChange);\n        // Initial delay is slightly longer to prevent the user from\n        // accidentally triggering the continuous increment/decrement.\n        this.setTimeout(function () {\n            _this.intervalId = window.setInterval(_this.handleContinuousChange, NumericInput_1.CONTINUOUS_CHANGE_INTERVAL);\n        }, NumericInput_1.CONTINUOUS_CHANGE_DELAY);\n    };\n    // Data logic\n    // ==========\n    NumericInput.prototype.handleNextValue = function (valueAsString) {\n        var _a, _b;\n        if (this.props.value == null) {\n            this.setState({ value: valueAsString });\n        }\n        (_b = (_a = this.props).onValueChange) === null || _b === void 0 ? void 0 : _b.call(_a, Number(parseStringToStringNumber(valueAsString, this.props.locale)), valueAsString, this.inputElement);\n    };\n    NumericInput.prototype.incrementValue = function (delta) {\n        // pretend we're incrementing from 0 if currValue is empty\n        var currValue = this.state.value === NumericInput_1.VALUE_EMPTY ? NumericInput_1.VALUE_ZERO : this.state.value;\n        var nextValue = this.roundAndClampValue(currValue, delta);\n        if (nextValue !== this.state.value) {\n            this.handleNextValue(nextValue);\n            this.setState({ shouldSelectAfterUpdate: this.props.selectAllOnIncrement });\n        }\n        // return value used in continuous change updates\n        return nextValue;\n    };\n    NumericInput.prototype.getIncrementDelta = function (direction, isShiftKeyPressed, isAltKeyPressed) {\n        var _a = this.props, majorStepSize = _a.majorStepSize, minorStepSize = _a.minorStepSize, stepSize = _a.stepSize;\n        if (isShiftKeyPressed && majorStepSize != null) {\n            return direction * majorStepSize;\n        }\n        else if (isAltKeyPressed && minorStepSize != null) {\n            return direction * minorStepSize;\n        }\n        else {\n            return direction * stepSize;\n        }\n    };\n    NumericInput.prototype.roundAndClampValue = function (value, delta) {\n        if (delta === void 0) { delta = 0; }\n        return NumericInput_1.roundAndClampValue(value, this.state.stepMaxPrecision, this.props.min, this.props.max, delta, this.props.locale);\n    };\n    NumericInput.prototype.updateDelta = function (direction, e) {\n        this.delta = this.getIncrementDelta(direction, e.shiftKey, e.altKey);\n        return this.delta;\n    };\n    var NumericInput_1;\n    NumericInput.displayName = DISPLAYNAME_PREFIX + \".NumericInput\";\n    NumericInput.VALUE_EMPTY = \"\";\n    NumericInput.VALUE_ZERO = \"0\";\n    NumericInput.defaultProps = {\n        allowNumericCharactersOnly: true,\n        buttonPosition: Position.RIGHT,\n        clampValueOnBlur: false,\n        defaultValue: NumericInput_1.VALUE_EMPTY,\n        large: false,\n        majorStepSize: 10,\n        minorStepSize: 0.1,\n        selectAllOnFocus: false,\n        selectAllOnIncrement: false,\n        stepSize: 1,\n    };\n    NumericInput.CONTINUOUS_CHANGE_DELAY = 300;\n    NumericInput.CONTINUOUS_CHANGE_INTERVAL = 100;\n    NumericInput = NumericInput_1 = __decorate([\n        polyfill\n    ], NumericInput);\n    return NumericInput;\n}(AbstractPureComponent2));\nexport { NumericInput };\n//# sourceMappingURL=numericInput.js.map"]},"metadata":{},"sourceType":"module"}